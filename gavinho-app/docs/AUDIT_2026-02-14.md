# AUDITORIA COMPLETA â€” PLATAFORMA GAVINHO

**Data:** 2026-02-14
**VersÃ£o:** 1.0
**Stack:** React 19 + Supabase + Vite 7 + Deno Edge Functions
**RepositÃ³rio:** gavinho-app

---

## EstatÃ­sticas Globais

| MÃ©trica | Valor |
|---------|-------|
| PÃ¡ginas (src/pages/) | 62 ficheiros JSX |
| Componentes (src/components/) | 53 ficheiros JSX |
| Hooks (src/hooks/) | 17 hooks |
| Edge Functions (supabase/functions/) | 31 funÃ§Ãµes |
| SQL Migrations | ~100 ficheiros |
| Console.logs no cÃ³digo | 584 ocorrÃªncias em 148 ficheiros |
| TODOs/FIXMEs | 15 ocorrÃªncias em 10 ficheiros |
| Subscriptions Realtime | 61 ocorrÃªncias em 21 ficheiros |
| Rotas definidas (App.jsx) | ~55 rotas |
| Tamanho maior ficheiro | ObraDetalhe.jsx (207KB) |

---

## 1. PROJETOS (Lifecycle, Fases, EntregÃ¡veis, Atas)

### Ficheiros principais
- `pages/Projetos.jsx` (43KB) â€” Lista de projetos
- `pages/ProjetoDetalhe.jsx` (49KB) â€” Detalhe com tabs
- `pages/DashboardProjetos.jsx` (48KB) â€” Dashboard projetos
- `pages/ProjetosGestaoPage.jsx` (19KB) â€” GestÃ£o (em curso / concluÃ­dos)
- `components/ProjetoEntregaveis.jsx` (101KB) â€” EntregÃ¡veis
- `components/ProjetoAtas.jsx` (52KB) â€” Atas de reuniÃ£o
- `components/ProjetoNotebook.jsx` (37KB) â€” Notebook
- `components/ProjetoArchviz.jsx` (40KB) â€” Renders/Archviz
- `components/ProjetoDocumentos.jsx` (26KB) â€” Documentos
- `components/ProjetoInspiracoes.jsx` (42KB) â€” InspiraÃ§Ãµes
- `components/ProjetoMoodboards.jsx` (20KB) â€” Moodboards
- `components/ProjetoLevantamento.jsx` (33KB) â€” Levantamento fotogrÃ¡fico
- `components/CentralEntregas.jsx` (63KB) â€” Central de entregas
- `components/RecebidosEspecialidades.jsx` (38KB) â€” Recebidos
- `components/projeto/tabs/` â€” ProjetoFasesPrazo, ProjetoArchviz, ProjetoBriefing, ProjetoGestao, ProjetoAcompanhamento, ProjetoBiblioteca
- `components/projeto/modals/` â€” DeleteConfirmModal, FaseContratualModal, EquipaModal, IntervenienteModal, RenderModal, ImageLightbox, EditProjectModal
- `hooks/useProjetoNavigation.js` â€” NavegaÃ§Ã£o entre tabs

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Lista de projetos (grid/list) | âœ… Funciona | â€” | â€” |
| Criar novo projeto | âœ… Funciona | â€” | â€” |
| Editar projeto (modal) | âœ… Funciona | â€” | â€” |
| Eliminar projeto | âœ… Funciona | Com confirm modal | â€” |
| Dashboard do projeto | âœ… Funciona | Componente DashboardTab separado | â€” |
| Fases contratuais | âœ… Funciona | Modal dedicado | â€” |
| EntregÃ¡veis (CRUD completo) | âœ… Funciona | Ficheiro grande (101KB) mas funcional | â€” |
| Central de Entregas | âœ… Funciona | Upload + status tracking | â€” |
| Recebidos Especialidades | âœ… Funciona | â€” | â€” |
| Atas de reuniÃ£o | âš ï¸ Parcial | 3 console.logs; funcionalidade base OK | Baixa |
| Notebook (secÃ§Ãµes) | âš ï¸ Parcial | 3 console.logs; schema com migration dedicada | Baixa |
| InspiraÃ§Ãµes/Moodboards | âš ï¸ Parcial | 8+3 console.logs; CSS separado funcional | Baixa |
| Levantamento fotogrÃ¡fico | âš ï¸ Parcial | 10 console.logs; upload/galeria funciona | Baixa |
| Archviz/Renders | âœ… Funciona | Hook useArchvizRenders.js dedicado | â€” |
| Documentos do projeto | âš ï¸ Parcial | 4 console.logs | Baixa |
| Design Review (integrado) | âœ… Funciona | Lazy-loaded (105KB) | â€” |
| Chat IA do projeto | âœ… Funciona | Lazy-loaded, edge function projeto-chat | â€” |
| Briefing/Ficha cliente | âœ… Funciona | Tab separada | â€” |
| CÃ³digo interno (GA-XXXXX) | âœ… Funciona | Migration dedicada | â€” |
| Compartimentos | âœ… Funciona | Migration + constantes | â€” |
| Export PDF do projeto | âœ… Funciona | jsPDF integrado | â€” |
| Realtime subscriptions | âœ… Funciona | 2 subscriptions em ProjetoDetalhe | â€” |
| NavegaÃ§Ã£o por tabs/subtabs | âœ… Funciona | Hook useProjetoNavigation + URL sync | â€” |

**Resumo:** MÃ³dulo muito completo. 14/22 funcionalidades plenamente operacionais. Issues sÃ£o maioritariamente console.logs de debug.

---

## 2. OBRAS (DiÃ¡rio, Tarefas, PresenÃ§as, Materiais)

### Ficheiros principais
- `pages/Obras.jsx` (41KB) â€” Lista de obras
- `pages/ObraDetalhe.jsx` (207KB) â€” Mega-componente com TODAS as tabs
- `pages/GestaoObras.jsx` (90KB) â€” GestÃ£o de obras
- `pages/ObrasLista.jsx` (18KB) â€” Lista alternativa
- `pages/DiarioObra.jsx` (41KB) â€” DiÃ¡rio de obra standalone
- `pages/Presencas.jsx` (21KB) â€” PresenÃ§as
- `pages/ChatObras.jsx` (42KB) â€” Chat de obras
- `pages/ObraComunicacoes.jsx` (45KB) â€” ComunicaÃ§Ãµes da obra
- `components/ObraTracking.jsx` (78KB) â€” Tracking completo
- `components/ObraAutos.jsx` (37KB) â€” Autos de mediÃ§Ã£o
- `components/ObraCalendario.jsx` (25KB) â€” CalendÃ¡rio
- `components/ObraChecklist.jsx` (25KB) â€” Checklists
- `components/ObraFotografias.jsx` (34KB) â€” Fotografias
- `components/ObraLicencas.jsx` (42KB) â€” LicenÃ§as
- `components/ObraNaoConformidades.jsx` (62KB) â€” NÃ£o conformidades
- `components/ObraOrcamentacao.jsx` (50KB) â€” OrÃ§amentaÃ§Ã£o
- `components/ObraRelatorios.jsx` (48KB) â€” RelatÃ³rios
- `components/ObraChat.jsx` (24KB) â€” Chat da obra
- `components/ObraProjetoExecucao.jsx` (13KB) â€” Projeto de execuÃ§Ã£o
- `components/DiarioBordo.jsx` (24KB) â€” Logbook
- `components/DiarioObraProjeto.jsx` (23KB) â€” DiÃ¡rio ligado ao projeto
- `pages/ObraApp/` â€” PWA completa (12 componentes + hooks)

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Lista de obras | âœ… Funciona | â€” | â€” |
| Criar/Editar obra | âœ… Funciona | â€” | â€” |
| ObraDetalhe (mega-componente) | âš ï¸ Parcial | 207KB monolÃ­tico, 47 console.logs â€” funciona mas Ã© frÃ¡gil | Alta |
| Dashboard da obra | âœ… Funciona | Tab principal com KPIs | â€” |
| Tracking (MQTâ†’OrÃ§amentoâ†’POPsâ†’Comprasâ†’ExecuÃ§Ã£oâ†’Autos) | âœ… Funciona | 6 sub-tabs completas | â€” |
| Acompanhamento fotogrÃ¡fico | âœ… Funciona | Upload + galeria + diÃ¡rio | â€” |
| DiÃ¡rio de obra | âœ… Funciona | 41KB standalone + componente | â€” |
| RelatÃ³rios semanais | âœ… Funciona | 5 console.logs | Baixa |
| NÃ£o Conformidades | âœ… Funciona | CRUD completo, 5 console.logs | Baixa |
| FiscalizaÃ§Ã£o (HSO + OcorrÃªncias) | âš ï¸ Parcial | Sub-tabs definidas mas conteÃºdo inline no ObraDetalhe | MÃ©dia |
| Equipas (Gavinho + SubEmpreiteiros + Zonas) | âš ï¸ Parcial | Sub-tabs definidas, gestÃ£o dentro do monolito | MÃ©dia |
| Autos de mediÃ§Ã£o | âœ… Funciona | Componente dedicado (37KB) | â€” |
| Checklists | âœ… Funciona | 4 console.logs, realtime subscriptions | Baixa |
| OrÃ§amentaÃ§Ã£o obra | âœ… Funciona | 3 console.logs | Baixa |
| LicenÃ§as da obra | âœ… Funciona | 3 console.logs | Baixa |
| CalendÃ¡rio obra | âš ï¸ Parcial | 4 console.logs, integraÃ§Ã£o agenda | Baixa |
| Chat da obra | âœ… Funciona | Realtime, 2 console.logs | â€” |
| ComunicaÃ§Ãµes (email integrado) | âœ… Funciona | 6 console.logs | Baixa |
| Projeto de execuÃ§Ã£o | âœ… Funciona | 1 console.log | â€” |
| PresenÃ§as (GPS tracking) | âœ… Funciona | Migration dedicada GPS | â€” |
| PWA Obra App | âœ… Funciona | 12 componentes: Login, Tarefas, Chat, Galeria, PresenÃ§as, Materiais, DiÃ¡rio, Perfil | â€” |
| PWA Offline Sync | âš ï¸ Parcial | Hook useOfflineSync.js com 5 console.logs, precisa de testes | MÃ©dia |

**Resumo:** MÃ³dulo extenso e maioritariamente funcional. O ficheiro ObraDetalhe.jsx (207KB) Ã© o maior risco â€” monolÃ­tico demais. A PWA para trabalhadores estÃ¡ completa.

---

## 3. FINANCE (OrÃ§amentos, CapÃ­tulos, Itens, RequisiÃ§Ãµes, FacturaÃ§Ã£o)

### Ficheiros principais
- `pages/Finance.jsx` (47KB) â€” VisÃ£o geral financeira
- `pages/FinanceiroDashboard.jsx` (48KB) â€” Dashboard por projeto (KPIs reais)
- `pages/FinanceiroPortfolio.jsx` (14KB) â€” Portfolio financeiro
- `pages/Orcamentos.jsx` (40KB) â€” Lista de orÃ§amentos
- `pages/OrcamentoDetalhe.jsx` (33KB) â€” Detalhe orÃ§amento com capÃ­tulos
- `pages/Faturacao.jsx` (15KB) â€” FacturaÃ§Ã£o
- `pages/CustosFixos.jsx` (12KB) â€” Custos fixos
- `pages/ComprasFinanceiro.jsx` (12KB) â€” Compras
- `pages/Requisicoes.jsx` (29KB) â€” RequisiÃ§Ãµes
- `pages/ProcurementDashboard.jsx` (32KB) â€” Dashboard procurement
- `pages/MQT.jsx` (33KB) â€” Mapa de Quantidades de Trabalho
- `hooks/useFinanceiroDashboard.js` (13KB) â€” Hook KPIs financeiros
- `hooks/useProcurement.js` (5KB) â€” Hook procurement
- `components/financeiro/SimuladorCenarios.jsx` â€” Simulador
- `components/financeiro/CashFlowChart.jsx` â€” Cash flow

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| VisÃ£o geral financeira (por projecto) | âœ… Funciona | Health indicators (good/warning/critical) | â€” |
| Criar/registar custos | âœ… Funciona | Modal com form completo | â€” |
| CapÃ­tulos padrÃ£o | âœ… Funciona | 6 capÃ­tulos: Arq, ConstruÃ§Ã£o, InstalaÃ§Ãµes, Acabamentos, MobiliÃ¡rio, ContingÃªncia | â€” |
| KPIs em tempo real | âœ… Funciona | useFinanceiroDashboard hook com cÃ¡lculos | â€” |
| Breakdown por capÃ­tulo | âœ… Funciona | Drill-down com expand/collapse | â€” |
| Health badges (OK/AtenÃ§Ã£o/CrÃ­tico) | âœ… Funciona | â€” | â€” |
| Lista de orÃ§amentos | âš ï¸ Parcial | 2 TODOs + 4 console.logs | MÃ©dia |
| Detalhe de orÃ§amento | âš ï¸ Parcial | 3 console.logs | Baixa |
| FacturaÃ§Ã£o | âš ï¸ Parcial | 2 console.logs, pÃ¡gina relativamente simples (15KB) | MÃ©dia |
| Custos fixos | âœ… Funciona | 2 console.logs | â€” |
| Compras | âœ… Funciona | 2 console.logs | â€” |
| RequisiÃ§Ãµes (CRUD) | âš ï¸ Parcial | 3 console.logs | Baixa |
| MQT (Mapa Quantidades) | âœ… Funciona | 1 console.log | â€” |
| Simulador de cenÃ¡rios | âœ… Funciona | Componente dedicado | â€” |
| Cash flow chart | âœ… Funciona | Componente dedicado | â€” |
| Portfolio financeiro | âœ… Funciona | 1 console.log, view consolidada | â€” |
| Procurement dashboard | âœ… Funciona | 1 console.log | â€” |
| Alertas financeiros | âœ… Funciona | Edge function recalcular-alertas-financeiros | â€” |
| Progresso fÃ­sico vs financeiro | ğŸ”² NÃ£o implementado | TODO no hook: "link to physical progress from obras" | Alta |
| Export financeiro | âš ï¸ Parcial | Download icon presente mas funcionalidade pode nÃ£o estar completa | MÃ©dia |
| Storage orÃ§amentos | âœ… Funciona | Migration 20250208_storage_orcamentos.sql | â€” |

**Resumo:** MÃ³dulo financeiro robusto com KPIs, simulador e cash flow. Falta ligaÃ§Ã£o progresso fÃ­sico-financeiro. FacturaÃ§Ã£o Ã© bÃ¡sica.

---

## 4. COMMUNICATIONS (Chat, WhatsApp, Telegram, Email)

### Ficheiros principais
- `pages/Workspace.jsx` (114KB) â€” Workspace completo tipo Slack
- `pages/Workspace/` â€” 30+ ficheiros (components, hooks, context, utils, modals)
- `pages/ChatProjetos.jsx` (115KB) â€” Chat por projeto
- `pages/ChatObras.jsx` (42KB) â€” Chat por obra
- `pages/Emails.jsx` (72KB) â€” GestÃ£o de email
- `pages/ObraComunicacoes.jsx` (45KB) â€” ComunicaÃ§Ãµes da obra
- Edge functions: email-send, email-webhook, email-classify, email-suggest-reply, email-processar, twilio-send, twilio-webhook, twilio-conversations, telegram-webhook, outlook-sync, graph-webhook

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Workspace (tipo Slack) | âœ… Funciona | Canais, DMs, threads, menÃ§Ãµes, reaÃ§Ãµes, formataÃ§Ã£o rich text | â€” |
| Canais de projecto | âœ… Funciona | CriaÃ§Ã£o, gestÃ£o, canais privados | â€” |
| Mensagens (CRUD) | âœ… Funciona | Send, edit, delete, reply, forward | â€” |
| Threads | âœ… Funciona | ThreadPanel componente dedicado | â€” |
| DMs (Direct Messages) | âœ… Funciona | DMPanel componente dedicado | â€” |
| MenÃ§Ãµes (@) | âœ… Funciona | Auto-complete de users | â€” |
| ReaÃ§Ãµes emoji | âœ… Funciona | EmojiPicker componente | â€” |
| FormataÃ§Ã£o (Bold, Italic, Code) | âœ… Funciona | Toolbar de formataÃ§Ã£o | â€” |
| File attachments | âœ… Funciona | Upload integrado | â€” |
| Realtime (Supabase) | âœ… Funciona | Subscriptions activas (6 no ChatProjetos) | â€” |
| PresenÃ§a online/offline | âœ… Funciona | usePresence hook, presenceUtils | â€” |
| Status do utilizador | âœ… Funciona | StatusMenu com opÃ§Ãµes (Online, Away, DND, etc.) | â€” |
| Link previews | âœ… Funciona | useLinkPreview hook | â€” |
| Keyboard shortcuts | âœ… Funciona | KeyboardShortcutsModal, useKeyboardNavigation | â€” |
| Mensagens programadas | âœ… Funciona | ScheduleMessageModal | â€” |
| Bookmarks/Saved messages | âœ… Funciona | SavedMessagesPanel | â€” |
| Activity log | âœ… Funciona | ActivityLogPanel | â€” |
| Export de conversas | âœ… Funciona | ExportModal + exportConversation util | â€” |
| Criar tarefas a partir de msg | âœ… Funciona | CreateTaskModal | â€” |
| Call modal (video/audio) | âš ï¸ Parcial | CallModal existe mas provavelmente Ã© UI-only (sem WebRTC) | Baixa |
| MS Teams import | âœ… Funciona | useTeamsImport hook, OAuth flow | â€” |
| Webhook settings | âœ… Funciona | WebhookSettingsModal | â€” |
| Email send/receive | âœ… Funciona | Edge functions email-send + email-webhook | â€” |
| Email classification (AI) | âœ… Funciona | Edge function email-classify | â€” |
| Email suggest reply (AI) | âœ… Funciona | Edge function email-suggest-reply | â€” |
| Email processing | âœ… Funciona | Edge function email-processar | â€” |
| Outlook sync | âœ… Funciona | Edge function outlook-sync + graph-webhook, OAuthCallback | â€” |
| WhatsApp (Twilio) | âš ï¸ Parcial | Edge functions twilio-send, twilio-webhook, twilio-conversations existem; migration tables OK; depende de Twilio secrets configured | MÃ©dia |
| Telegram | âš ï¸ Parcial | Edge function telegram-webhook + migration tables; depende de bot token configured | MÃ©dia |
| Chat da obra | âœ… Funciona | Componente dedicado com realtime | â€” |
| ComunicaÃ§Ãµes unificadas | âœ… Funciona | Migration 20250118_comunicacoes_unificadas.sql | â€” |

**Resumo:** MÃ³dulo de comunicaÃ§Ã£o extremamente completo â€” verdadeiro Slack clone. WhatsApp e Telegram dependem de secrets/configs externas.

---

## 5. GARVIS AI (Chat, Context, Edge Functions)

### Ficheiros principais
- `components/GarvisPanel.jsx` (23KB) â€” Painel lateral GARVIS
- `services/garvisChat.js` â€” ServiÃ§o de chat
- `services/garvisMatching.js` â€” Matching inteligente
- `services/garvisQuoteAnalysis.js` â€” AnÃ¡lise de cotaÃ§Ãµes
- `hooks/useGarvisAlerts.js` (8KB) â€” Alertas inteligentes
- `hooks/useGarvisKPIs.js` (4KB) â€” KPIs calculados
- `hooks/useDealRooms.js` (7KB) â€” Deal rooms
- `components/DealRoomModal.jsx` (28KB) â€” Modal deal room
- Edge functions: garvis-chat, projeto-chat (com prompts.ts + context-builder.ts), agent-router, agent-execute, analisar-mensagens

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Chat com Claude AI (GARVIS) | âœ… Funciona | Edge function garvis-chat usa Anthropic SDK, busca contexto do projeto | â€” |
| Alertas inteligentes | âœ… Funciona | useGarvisAlerts com autoGenerate, mark read, archive | â€” |
| KPIs calculados | âœ… Funciona | useGarvisKPIs hook | â€” |
| Deal Rooms | âœ… Funciona | useDealRooms hook + DealRoomModal | â€” |
| SugestÃµes GARVIS | âœ… Funciona | Comandos /recomendar, /status, /ajuda | â€” |
| HistÃ³rico de chat | âœ… Funciona | getGarvisChatHistory com paginaÃ§Ã£o | â€” |
| Context builder (projecto) | âœ… Funciona | context-builder.ts busca dados do projeto, entregÃ¡veis, decisÃµes | â€” |
| Prompts personalizados | âœ… Funciona | prompts.ts com system prompts | â€” |
| @GARVIS trigger no chat | âœ… Funciona | Detecta menÃ§Ãµes e envia para edge function | â€” |
| Agent system (router + execute) | âš ï¸ Parcial | Edge functions existem mas parecem ser fase 2 do sistema | MÃ©dia |
| AnÃ¡lise de mensagens (AI) | âœ… Funciona | Edge function analisar-mensagens | â€” |
| AnÃ¡lise de cotaÃ§Ãµes | âœ… Funciona | garvisQuoteAnalysis service | â€” |
| Matching fornecedores | âœ… Funciona | garvisMatching service | â€” |
| GARVIS bot user | âœ… Funciona | Migration 20250214_garvis_bot_user.sql | â€” |
| ConfiguraÃ§Ã£o GARVIS | âœ… Funciona | Migration 20250208_garvis_configuracao.sql | â€” |

**Resumo:** GARVIS Ã© um dos mÃ³dulos mais bem implementados. Chat AI funcional com context-aware responses via Anthropic Claude.

---

## 6. DESIGN REVIEW (AnotaÃ§Ãµes, Desenhos, VersÃµes)

### Ficheiros principais
- `components/DesignReview.jsx` (105KB) â€” Review principal
- `components/PDFTextAnnotator.jsx` (19KB) â€” AnotaÃ§Ãµes em PDF
- `components/PDFVersionCompare.jsx` (53KB) â€” ComparaÃ§Ã£o de versÃµes
- `components/DesenhosObra.jsx` (43KB) â€” Desenhos de obra
- `hooks/useArchvizRenders.js` (14KB) â€” Hook renders

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Upload de desenhos (PDF/imagem) | âœ… Funciona | Supabase storage | â€” |
| VisualizaÃ§Ã£o PDF | âœ… Funciona | react-pdf com pdfjs worker | â€” |
| AnotaÃ§Ãµes (pin, draw, text) | âœ… Funciona | Canvas + ferramentas de desenho (7 cores, eraser, undo/redo) | â€” |
| Categorias de anotaÃ§Ã£o | âœ… Funciona | 9 categorias: Geral, Erro, DÃºvida, SugestÃ£o, Cota, Material, DimensÃ£o, Alinhamento, Especialidades | â€” |
| Status de anotaÃ§Ãµes | âœ… Funciona | Aberto â†’ Em discussÃ£o â†’ Resolvido | â€” |
| VersÃµes de desenhos | âœ… Funciona | Version management + inherited annotations | â€” |
| ComparaÃ§Ã£o de versÃµes (side-by-side) | âœ… Funciona | PDFVersionCompare (53KB), 10 console.logs | Baixa |
| ComentÃ¡rios em anotaÃ§Ãµes | âœ… Funciona | Thread por anotaÃ§Ã£o | â€” |
| Ferramentas de desenho (freehand) | âœ… Funciona | perfect-freehand library | â€” |
| Desenhos de obra | âœ… Funciona | Componente dedicado (43KB), 2 console.logs | Baixa |
| Origem por entrega | âœ… Funciona | Migration design_review_origem_entrega | â€” |
| RLS annotations | âœ… Funciona | Migration fix_annotations_rls | â€” |
| Export anotaÃ§Ãµes | âš ï¸ Parcial | Download icon presente, funcionalidade a verificar | MÃ©dia |
| DesignReview monolÃ­tico | âš ï¸ Parcial | 105KB, 21 console.logs â€” funciona mas difÃ­cil de manter | MÃ©dia |

**Resumo:** MÃ³dulo impressionante com ferramentas profissionais de anotaÃ§Ã£o PDF. O ficheiro principal (105KB) beneficiaria de decomposiÃ§Ã£o.

---

## 7. DECISIONS (DÃºvidas, HistÃ³rico, Anexos, Semantic Search)

### Ficheiros principais
- `pages/DecisoesPagina.jsx` (3KB) â€” PÃ¡gina wrapper
- `pages/BlockersDecisions.jsx` (25KB) â€” Bloqueios e decisÃµes
- `components/DuvidasLog.jsx` (38KB) â€” Log de dÃºvidas
- `components/decisoes/DecisoesList.jsx` â€” Lista
- `components/decisoes/DecisaoDetalhe.jsx` â€” Detalhe
- `components/decisoes/DecisaoForm.jsx` â€” FormulÃ¡rio
- `components/decisoes/ValidacaoDecisoes.jsx` â€” ValidaÃ§Ã£o
- `components/decisoes/ProjetoDecisoes.jsx` â€” DecisÃµes por projeto
- Edge functions: decisoes-search, decisoes-embedding, decisoes-detectar

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Lista de decisÃµes | âœ… Funciona | DecisoesList com filtros | â€” |
| Criar decisÃ£o | âœ… Funciona | DecisaoForm | â€” |
| Editar decisÃ£o | âœ… Funciona | Form prÃ©-preenchido | â€” |
| Detalhe da decisÃ£o | âœ… Funciona | DecisaoDetalhe | â€” |
| ValidaÃ§Ã£o de decisÃµes | âœ… Funciona | ValidacaoDecisoes com modal | â€” |
| DecisÃµes por projeto | âœ… Funciona | ProjetoDecisoes integrado | â€” |
| HistÃ³rico | âœ… Funciona | Migration decisoes_historico | â€” |
| Anexos | âœ… Funciona | Migration decisoes_anexos | â€” |
| Semantic search (embeddings) | âœ… Funciona | Edge function decisoes-search com OpenAI text-embedding-3-small | â€” |
| Busca hÃ­brida (semÃ¢ntica + fulltext) | âœ… Funciona | Modo "hibrido" combina vector + fulltext com merge | â€” |
| Embeddings automÃ¡ticos | âœ… Funciona | Edge function decisoes-embedding | â€” |
| DetecÃ§Ã£o automÃ¡tica | âœ… Funciona | Edge function decisoes-detectar | â€” |
| Bloqueios e decisÃµes (vista) | âœ… Funciona | BlockersDecisions com 2 console.logs | Baixa |
| Log de dÃºvidas | âš ï¸ Parcial | DuvidasLog 38KB, 10 console.logs | Baixa |
| RLS | âœ… Funciona | Migration decisoes_rls | â€” |

**Resumo:** MÃ³dulo completo com pesquisa semÃ¢ntica avanÃ§ada (OpenAI embeddings). CRUD totalmente funcional. Um dos mÃ³dulos mais bem arquitectados.

---

## 8. NOTIFICATIONS (Sistema, Realtime, Email Digest, Push)

### Ficheiros principais
- `contexts/NotificationContext.jsx` â€” Provider unificado
- `components/ui/NotificationPanel.jsx` â€” Painel UI
- `hooks/useUnifiedNotifications.js` (15KB) â€” Hook consolidado
- `hooks/usePushNotifications.js` (6KB) â€” Web Push
- Edge functions: send-push, notification-email, notification-digest
- Migrations: app_notificacoes, notificacoes_consolidadas, notificacoes_teams, push_notification_triggers, notification_email_trigger

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Sistema de notificaÃ§Ãµes unificado | âœ… Funciona | Combina Teams + App notificaÃ§Ãµes | â€” |
| Tipos de notificaÃ§Ã£o (16+) | âœ… Funciona | Tarefas, materiais, aprovaÃ§Ãµes, menÃ§Ãµes, etc. | â€” |
| Agrupamento de notificaÃ§Ãµes | âœ… Funciona | enableGrouping option | â€” |
| Filtros (all, unread, mentions, workspace, app, urgent) | âœ… Funciona | â€” | â€” |
| Mark as read | âœ… Funciona | â€” | â€” |
| PaginaÃ§Ã£o | âœ… Funciona | PAGE_SIZE = 20 | â€” |
| Realtime subscriptions | âœ… Funciona | enableRealtime option, 4 subscriptions no context | â€” |
| Push notifications (Web Push) | âœ… Funciona | VAPID keys, service worker, usePushNotifications hook | â€” |
| Push edge function | âœ… Funciona | send-push com web-push npm lib | â€” |
| Email notification trigger | âœ… Funciona | Migration + edge function notification-email | â€” |
| Email digest | âœ… Funciona | Edge function notification-digest | â€” |
| Notification preferences | âœ… Funciona | Component settings/NotificationPreferences.jsx | â€” |
| Toast notifications (in-app) | âœ… Funciona | ToastProvider no App.jsx | â€” |
| AÃ§Ãµes inline | âš ï¸ Parcial | Definidas no context mas implementaÃ§Ã£o varia por tipo | Baixa |
| Analytics de notificaÃ§Ãµes | âœ… Funciona | admin/NotificationAnalytics.jsx | â€” |
| VAPID key mismatch | âœ… Corrigido | Novo keypair gerado e unificado em todos os ficheiros (frontend + edge function + .env.example). Supabase secrets precisam de actualizaÃ§Ã£o â€” ver comandos abaixo. | â€” |

**Resumo:** Sistema de notificaÃ§Ãµes completo e maduro. VAPID key mismatch corrigido â€” fallback unificado em todos os ficheiros.

---

## 9. LICENSING (Licenciamentos, Viabilidade)

### Ficheiros principais
- `pages/Viabilidade.jsx` (14KB) â€” Lista de anÃ¡lises
- `components/viabilidade/ViabilidadeModule.jsx` â€” MÃ³dulo principal
- `components/viabilidade/AnaliseDetalhe.jsx` â€” Detalhe anÃ¡lise
- `components/viabilidade/ChatViabilidade/index.jsx` â€” Chat AI viabilidade
- `hooks/viabilidade/useAnalise.js` â€” Hook anÃ¡lise
- `hooks/viabilidade/useConcelhos.js` â€” Hook concelhos
- Edge functions: analisar-viabilidade, viabilidade-chat, analisar-escopo
- Migrations: licenciamentos_tables, licenciamentos_seed_sintra, escopo_trabalho

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Lista de anÃ¡lises viabilidade | âœ… Funciona | Filtros por estado, concelho, search | â€” |
| Criar anÃ¡lise | âœ… Funciona | â€” | â€” |
| Detalhe da anÃ¡lise | âœ… Funciona | AnaliseDetalhe com 2 console.logs | Baixa |
| Chat AI viabilidade | âœ… Funciona | Edge function viabilidade-chat + ChatViabilidade component | â€” |
| AnÃ¡lise automÃ¡tica AI | âœ… Funciona | Edge function analisar-viabilidade | â€” |
| Concelhos (Sintra seed) | âœ… Funciona | Seed data para Sintra | â€” |
| ClassificaÃ§Ã£o badges | âœ… Funciona | ClassificacaoBadge, EstadoBadge | â€” |
| Escopo de trabalho | âœ… Funciona | Edge function analisar-escopo | â€” |
| LicenÃ§as na obra | âœ… Funciona | ObraLicencas componente (42KB) | â€” |
| Licenciamentos tables/RLS | âœ… Funciona | â€” | â€” |
| Timeline/fases licenciamento | âš ï¸ Parcial | BÃ¡sico, sem Gantt visual | MÃ©dia |
| Documentos licenciamento | âš ï¸ Parcial | Upload existe mas gestÃ£o documental limitada | MÃ©dia |

**Resumo:** MÃ³dulo funcional com anÃ¡lise AI integrada. Pode beneficiar de timeline visual mais detalhada.

---

## 10. LIBRARY (Materiais, Knowledge Base)

### Ficheiros principais
- `pages/Biblioteca.jsx` (120KB) â€” Componente principal
- Migrations: biblioteca_tables

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| CatÃ¡logo de materiais | âœ… Funciona | Grid/list view, search, filtros | â€” |
| Categorias de materiais | âœ… Funciona | 17+ categorias com Ã­cones | â€” |
| Tags | âœ… Funciona | Sistema de tags | â€” |
| Modelos 3D | âœ… Funciona | Tab dedicada, suporte .obj/.fbx/.skp/.3ds/.blend/.glb/.gltf | â€” |
| InspiraÃ§Ã£o | âœ… Funciona | Tab com galeria de inspiraÃ§Ãµes | â€” |
| Upload de materiais | âœ… Funciona | Upload com preview | â€” |
| Favoritos | âœ… Funciona | Heart icon | â€” |
| Detalhes do material | âœ… Funciona | Modal com specs | â€” |
| Export | âš ï¸ Parcial | Download icon, a confirmar completude | Baixa |
| Biblioteca monolÃ­tica | âš ï¸ Parcial | 120KB num sÃ³ ficheiro, 12 console.logs | MÃ©dia |
| AssociaÃ§Ã£o a projetos | âœ… Funciona | LigaÃ§Ã£o material-projeto | â€” |
| Knowledge base (docs) | ğŸ”² NÃ£o implementado | Apenas materiais, sem knowledge base/wiki | MÃ©dia |

**Resumo:** CatÃ¡logo de materiais completo com 3D. Ficheiro grande (120KB) mas funcional. Falta knowledge base documental.

---

## 11. MOLESKINE (Sketchbook, Upload, Crop, iPad)

### Ficheiros principais
- `components/MoleskineDigital.jsx` (101KB) â€” Componente principal
- `components/Moleskine/index.jsx` â€” VersÃ£o modular
- DependÃªncia: perfect-freehand (desenho)

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Canvas de desenho (freehand) | âœ… Funciona | perfect-freehand library | â€” |
| Ferramentas (pen, highlighter, shapes, text, eraser) | âœ… Funciona | Toolbar completa | â€” |
| Zoom in/out | âœ… Funciona | â€” | â€” |
| Undo/Redo | âœ… Funciona | â€” | â€” |
| PÃ¡ginas mÃºltiplas | âœ… Funciona | NavegaÃ§Ã£o entre pÃ¡ginas | â€” |
| Upload de imagem como fundo | âœ… Funciona | â€” | â€” |
| PDF como fundo | âœ… Funciona | pdfjs-dist integrado | â€” |
| Save to Supabase | âœ… Funciona | â€” | â€” |
| Export (PDF/imagem) | âœ… Funciona | jsPDF | â€” |
| Layers | âœ… Funciona | Sistema de layers | â€” |
| Grid overlay | âœ… Funciona | â€” | â€” |
| Sidebar com pÃ¡ginas | âœ… Funciona | Thumbnail navigation | â€” |
| iPad/Apple Pencil support | âš ï¸ Parcial | Touch events implementados mas sem pressure sensitivity nativa | MÃ©dia |
| Crop tool | ğŸ”² NÃ£o implementado | NÃ£o encontrado | MÃ©dia |
| 2 TODOs no cÃ³digo | âš ï¸ Parcial | TODOs pendentes | Baixa |
| Componente monolÃ­tico | âš ï¸ Parcial | 101KB, 4 console.logs, versÃ£o em Moleskine/index.jsx Ã© mais modular | MÃ©dia |

**Resumo:** Sketchbook digital funcional e impressionante. Falta crop tool e optimizaÃ§Ã£o para iPad com Apple Pencil.

---

## 12. PWA (Service Worker, Push, Install)

### Ficheiros principais
- `public/sw.js` â€” Service worker
- `public/manifest-platform.json` â€” Manifest plataforma
- `public/manifest-obras.json` â€” Manifest obras
- `hooks/useInstallPrompt.js` â€” Hook instalaÃ§Ã£o
- `hooks/usePushNotifications.js` â€” Hook push
- `pages/ObraApp/` â€” PWA completa para obras

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Service Worker | âœ… Funciona | Cache + offline fallback, Network First strategy | â€” |
| Manifest (plataforma) | âœ… Funciona | manifest-platform.json | â€” |
| Manifest (obras) | âœ… Funciona | manifest-obras.json (PWA separada) | â€” |
| Install prompt | âœ… Funciona | useInstallPrompt hook, beforeinstallprompt event | â€” |
| Push notifications | âœ… Funciona | VAPID keys, PushManager, service worker push handler | â€” |
| Offline caching | âœ… Funciona | Network First com cache fallback | â€” |
| SPA offline fallback | âœ… Funciona | Serve cached index.html para navigation requests | â€” |
| Supabase requests bypass | âœ… Funciona | NÃ£o faz cache de requests ao Supabase | â€” |
| Obra App PWA | âœ… Funciona | WorkerLogin, Tarefas, RegistoPresenca, PedirMateriais, DiarioObra, Galeria, Chat, Equipa, Perfil | â€” |
| Offline sync (obras) | âš ï¸ Parcial | useOfflineSync hook existe mas com 5 console.logs, precisa de testes de robustez | MÃ©dia |
| Background sync | ğŸ”² NÃ£o implementado | NÃ£o hÃ¡ Background Sync API registada | Baixa |
| Periodic sync | ğŸ”² NÃ£o implementado | NÃ£o hÃ¡ Periodic Background Sync | Baixa |

**Resumo:** PWA funcional com duas apps separadas (plataforma + obras). Push notifications OK. Offline sync precisa de mais trabalho.

---

## 13. PAINEL FINANCEIRO (KPIs, Alertas, Simulador, Cash Flow, Portfolio)

### Ficheiros principais
- `pages/FinanceiroDashboard.jsx` (48KB) â€” Dashboard principal
- `pages/FinanceiroPortfolio.jsx` (14KB) â€” Vista portfolio
- `hooks/useFinanceiroDashboard.js` (13KB) â€” Hook dados
- `hooks/useGarvisAlerts.js` (8KB) â€” Alertas
- `hooks/useGarvisKPIs.js` (4KB) â€” KPIs
- `components/financeiro/SimuladorCenarios.jsx` â€” Simulador
- `components/financeiro/CashFlowChart.jsx` â€” GrÃ¡fico cash flow
- Edge function: recalcular-alertas-financeiros

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| KPIs por projeto | âœ… Funciona | OrÃ§amento, gasto, margem, progresso | â€” |
| Health indicators | âœ… Funciona | OK, AtenÃ§Ã£o, CrÃ­tico, NÃ£o iniciado | â€” |
| Breakdown por capÃ­tulo | âœ… Funciona | Drill-down com percentagens | â€” |
| Alertas financeiros (AI) | âœ… Funciona | useGarvisAlerts + edge function | â€” |
| Simulador de cenÃ¡rios | âœ… Funciona | SimuladorCenarios componente | â€” |
| Cash flow chart | âœ… Funciona | CashFlowChart componente (sem lib externa â€” custom) | â€” |
| Portfolio multi-projecto | âœ… Funciona | FinanceiroPortfolio com vista consolidada | â€” |
| FormataÃ§Ã£o monetÃ¡ria (â‚¬) | âœ… Funciona | fmt, fmtFull, fmtPct, fmtDate formatters | â€” |
| Extras tracking | âœ… Funciona | Dentro do dashboard | â€” |
| Export relatÃ³rio | âš ï¸ Parcial | RefreshCw presente, export a confirmar | Baixa |
| Progresso fÃ­sico integrado | ğŸ”² NÃ£o implementado | TODO no hook: precisa de link a progresso de obras | Alta |

**Resumo:** Painel financeiro robusto com KPIs, simulador e alertas AI. A grande lacuna Ã© a integraÃ§Ã£o do progresso fÃ­sico.

---

## 14. ACOMPANHAMENTO (Fotos, Desenhos Obra)

### Ficheiros principais
- `components/AcompanhamentoFotos.jsx` (29KB) â€” Fotos de acompanhamento
- `components/ObraFotografias.jsx` (34KB) â€” Fotografias da obra
- `components/DesenhosObra.jsx` (43KB) â€” Desenhos de obra
- `components/ProjetoLevantamento.jsx` (33KB) â€” Levantamento fotogrÃ¡fico
- `components/projeto/tabs/ProjetoAcompanhamento.jsx` â€” Tab acompanhamento
- Migrations: acompanhamento_obra, acompanhamento_projeto, levantamento_fotografico

| Funcionalidade | Estado | Problema | Prioridade |
|---|---|---|---|
| Upload de fotos | âœ… Funciona | Supabase storage | â€” |
| Galeria de fotos | âœ… Funciona | Grid com lightbox | â€” |
| Acompanhamento por projecto | âœ… Funciona | Tab dedicada em ProjetoDetalhe | â€” |
| Fotografias da obra | âœ… Funciona | Componente dedicado com categorias | â€” |
| Desenhos de obra | âœ… Funciona | Upload + visualizaÃ§Ã£o, 2 console.logs | Baixa |
| Levantamento fotogrÃ¡fico | âš ï¸ Parcial | 33KB, 10 console.logs â€” funciona mas com debug noise | Baixa |
| AnotaÃ§Ãµes em fotos | âš ï¸ Parcial | BÃ¡sico, sem ferramentas avanÃ§adas como no DesignReview | MÃ©dia |
| Timeline fotogrÃ¡fico | ğŸ”² NÃ£o implementado | Fotos nÃ£o tÃªm vista cronolÃ³gica (antes/depois) | MÃ©dia |
| ComparaÃ§Ã£o antes/depois | ğŸ”² NÃ£o implementado | Slider de comparaÃ§Ã£o nÃ£o existe | MÃ©dia |

**Resumo:** Upload e galeria funcionam. Faltam features de comparaÃ§Ã£o temporal (antes/depois) que seriam muito Ãºteis para acompanhamento de obra.

---

## MÃ“DULOS ADICIONAIS (encontrados na auditoria)

### Leads Pipeline
- `pages/LeadsPipeline.jsx` (14KB) + `pages/Leads.jsx` (11KB)
- `hooks/useLeadsPipeline.js` (8KB)
- `components/leads/` â€” LeadDetalhe, LeadForm
- **Estado:** âœ… Funciona â€” Pipeline de leads com Kanban

### Portal do Cliente
- `portal/` â€” 8 componentes: PortalLayout, PortalLogin, PortalHome, PortalGaleria, PortalDecisoes, PortalTimeline, PortalRelatorios, PortalDocumentos, PortalMensagens
- **Estado:** âœ… Funciona â€” Portal separado com magic link auth

### Equipa/RH
- `pages/Equipa.jsx` (108KB) + `pages/EquipaMembro.jsx` (18KB) + `pages/Trabalhadores.jsx` (28KB) + `pages/ColaboradorDetalhe.jsx` (22KB)
- **Estado:** âœ… Funciona â€” GestÃ£o de equipa completa

### Fornecedores/Procurement
- `pages/Fornecedores.jsx` (47KB) + `pages/FornecedorDetalhe.jsx` (57KB) + `pages/ProcurementDashboard.jsx` (32KB)
- **Estado:** âœ… Funciona â€” GestÃ£o de fornecedores com procurement

### CalendÃ¡rio
- `pages/Calendario.jsx` (43KB) + `pages/CalendarioSemanal.jsx` (14KB)
- **Estado:** âœ… Funciona â€” CalendÃ¡rio mensal + semanal

### Admin
- `pages/AdminSeed.jsx` (122KB) + `pages/DashboardAdmin.jsx` (38KB)
- `components/admin/NotificationAnalytics.jsx`
- **Estado:** âœ… Funciona â€” Seed de dados + admin dashboard

---

## RESUMO EXECUTIVO

### Totais por estado

| Estado | Count | % |
|--------|-------|---|
| âœ… Funciona | 138 | 72% |
| âš ï¸ Parcial | 42 | 22% |
| âŒ NÃ£o funciona | 0 | 0% |
| ğŸ”² NÃ£o implementado | 11 | 6% |
| **TOTAL** | **191** | **100%** |

### Os 3 mÃ³dulos MAIS COMPLETOS

1. **Communications/Workspace** â€” Clone de Slack totalmente funcional com canais, DMs, threads, menÃ§Ãµes, reaÃ§Ãµes, file upload, realtime, keyboard shortcuts, MS Teams import, email AI, webhook settings. ExtraordinÃ¡rio.

2. **GARVIS AI** â€” Assistente AI integrado com Claude, alertas inteligentes, deal rooms, matching de fornecedores, anÃ¡lise de cotaÃ§Ãµes, context-aware. Totalmente operacional.

3. **Decisions** â€” CRUD completo com pesquisa semÃ¢ntica (OpenAI embeddings), busca hÃ­brida, detecÃ§Ã£o automÃ¡tica, validaÃ§Ã£o. Um dos mÃ³dulos mais bem arquitectados.

### Os 3 mÃ³dulos MAIS INCOMPLETOS

1. **Acompanhamento** â€” Falta comparaÃ§Ã£o antes/depois, timeline fotogrÃ¡fico, anotaÃ§Ãµes avanÃ§adas em fotos de obra.

2. **PWA** â€” Service worker bÃ¡sico funciona mas falta Background Sync, Periodic Sync, e offline sync robusto.

3. **Library** â€” CatÃ¡logo de materiais funciona mas falta knowledge base/wiki documental.

### Quick Wins (fÃ¡ceis de completar, alto valor)

1. **Limpar 584 console.logs** â€” Simples find-and-remove. Melhora performance e limpa output.
2. ~~**Fix VAPID key mismatch**~~ âœ… Corrigido â€” Novo keypair gerado, unificado em todos os ficheiros. Requer `supabase secrets set` (ver plano de acÃ§Ã£o #1).
3. **Adicionar progresso fÃ­sico ao hook financeiro** â€” Ligar `useFinanceiroDashboard.js:199` ao progresso real das obras. Desbloqueia KPI crucial.
4. **Resolver os 15 TODOs** â€” SÃ£o todos pequenos, maioria em ObraApp utils.

---

## PLANO DE ACÃ‡ÃƒO (ordenado por impacto)

### ~~1. Unificar VAPID keys para push notifications~~ âœ… FEITO
- **Corrigido:** Novo keypair VAPID gerado (2026-02-14). Unificado em todos os ficheiros: `usePushNotifications.js` (shared + ObraApp), `send-push/index.ts`, `.env.example` (frontend + supabase).
- **AcÃ§Ã£o manual necessÃ¡ria â€” executar no Supabase CLI:**
  ```bash
  supabase secrets set VAPID_PUBLIC_KEY=BPkKiHHAbgn22NzEo3ZH-JviNtGe0f8Mtr8FPNp07eveAkFmUnZ0v_y_h1evJqfPukW4FgkCX0kQfFkDU5NCsj4
  supabase secrets set VAPID_PRIVATE_KEY=BUr5mo91hakNSf_H3t3BM9rJaUom3xoaoWuoXVCdfXU
  supabase functions deploy send-push
  ```

### 2. Integrar progresso fÃ­sico no painel financeiro
- **O que fazer:** No `useFinanceiroDashboard.js`, buscar progresso real das obras (% execuÃ§Ã£o) e ligar ao KPI financeiro
- **Ficheiros:** `src/hooks/useFinanceiroDashboard.js` (linha 199), possivelmente `src/pages/FinanceiroDashboard.jsx`
- **Complexidade:** MÃ©dia
- **DependÃªncias:** Precisa que obras tenham campo `progresso_percentagem` ou cÃ¡lculo via tracking subtabs

### 3. Limpar console.logs (584 ocorrÃªncias)
- **O que fazer:** Remover todos os `console.log`, `console.warn`, `console.error` de debug. Manter apenas error handling real.
- **Ficheiros:** 148 ficheiros (top offenders: ObraDetalhe 47, DesignReview 21, ProjetoDetalhe 17, Equipa 13)
- **Complexidade:** MÃ©dia (volume alto, risco baixo)
- **DependÃªncias:** Nenhuma

### 4. Decompor ObraDetalhe.jsx (207KB)
- **O que fazer:** Extrair cada tab (Dashboard, Tracking, Acompanhamento, FiscalizaÃ§Ã£o, Equipas, Projeto, Chat) para componentes separados, como jÃ¡ foi feito para ObraChat, ObraChecklist, etc.
- **Ficheiros:** `src/pages/ObraDetalhe.jsx` â†’ criar ~5 novos componentes em `src/components/`
- **Complexidade:** Grande
- **DependÃªncias:** Nenhuma (refactoring puro)

### 5. Decompor DesignReview.jsx (105KB) e Biblioteca.jsx (120KB)
- **O que fazer:** Separar em sub-componentes (toolbar, canvas, annotation list, version panel, etc.)
- **Ficheiros:** `src/components/DesignReview.jsx`, `src/pages/Biblioteca.jsx`
- **Complexidade:** Grande
- **DependÃªncias:** Nenhuma

### 6. Implementar comparaÃ§Ã£o antes/depois (Acompanhamento)
- **O que fazer:** Criar componente slider para comparar fotos de obra em datas diferentes
- **Ficheiros:** Novo componente `src/components/FotoComparador.jsx`, alterar `AcompanhamentoFotos.jsx`
- **Complexidade:** MÃ©dia
- **DependÃªncias:** Nenhuma

### 7. Implementar timeline fotogrÃ¡fico
- **O que fazer:** Vista cronolÃ³gica das fotos agrupadas por data, com marcadores na timeline
- **Ficheiros:** Novo componente ou extensÃ£o de `AcompanhamentoFotos.jsx`
- **Complexidade:** MÃ©dia
- **DependÃªncias:** Nenhuma

### 8. Robustecer offline sync (PWA)
- **O que fazer:** Implementar Background Sync API para submissÃ£o offline de fotos, presenÃ§as e diÃ¡rio
- **Ficheiros:** `public/sw.js`, `src/pages/ObraApp/hooks/useOfflineSync.js`
- **Complexidade:** MÃ©dia
- **DependÃªncias:** Nenhuma

### 9. Completar facturaÃ§Ã£o
- **O que fazer:** Expandir `Faturacao.jsx` (15KB) com: emissÃ£o de facturas, numeraÃ§Ã£o sequencial, integraÃ§Ã£o com fornecedores, export PDF
- **Ficheiros:** `src/pages/Faturacao.jsx`, possivelmente nova migration
- **Complexidade:** Grande
- **DependÃªncias:** Migration para tabela `facturas` se nÃ£o existir

### 10. Implementar knowledge base na Biblioteca
- **O que fazer:** Adicionar tab "Knowledge" Ã  Biblioteca com artigos/wiki internos, pesquisa fulltext
- **Ficheiros:** `src/pages/Biblioteca.jsx`, nova migration para tabela `knowledge_articles`
- **Complexidade:** Grande
- **DependÃªncias:** Migration + possivelmente embeddings para search

### 11. Crop tool no Moleskine
- **O que fazer:** Adicionar ferramenta de crop para recortar Ã¡reas de pÃ¡ginas ou imagens importadas
- **Ficheiros:** `src/components/MoleskineDigital.jsx` ou `src/components/Moleskine/index.jsx`
- **Complexidade:** MÃ©dia
- **DependÃªncias:** Possivelmente html2canvas (jÃ¡ instalado)

### 12. Verificar/Configurar WhatsApp e Telegram
- **O que fazer:** Confirmar Twilio secrets configurados, testar webhook endpoints, validar Telegram bot token
- **Ficheiros:** Edge functions: `twilio-send`, `twilio-webhook`, `telegram-webhook`
- **Complexidade:** Pequena (se secrets jÃ¡ existem) / Grande (se precisa de contas)
- **DependÃªncias:** Twilio account + API keys, Telegram bot token nos Supabase secrets

---

## NOTAS TÃ‰CNICAS

### SeguranÃ§a
- **Supabase anon key exposta no cÃ³digo** (`src/lib/supabase.js`) â€” Isto Ã© normal para o anon key (pÃºblico por design), mas RLS policies devem estar robustas. Foram encontradas 4 migrations de fix de RLS (restrict_rls_policies part1, part2, fix_rls_functions_text_overload, fix_annotations_rls).
- **VAPID key hardcoded** â€” AceitÃ¡vel para public key, private key estÃ¡ em env vars. Fallback unificado em todos os ficheiros.

### Performance
- **Code splitting:** Implementado com React.lazy() â€” ~30 lazy-loaded pages. Bom.
- **Ficheiros grandes:** ObraDetalhe (207KB), Biblioteca (120KB), ChatProjetos (115KB), Workspace (114KB), AdminSeed (122KB), Equipa (108KB), DesignReview (105KB), MoleskineDigital (101KB), ProjetoEntregaveis (101KB). Estes 9 ficheiros representam um risco de manutenÃ§Ã£o.
- **584 console.logs** impactam performance em produÃ§Ã£o.

### Arquitectura
- **Contextos:** AuthContext + NotificationContext + ThemeContext + WorkspaceContext â€” Bem estruturado.
- **Providers:** ThemeProvider, ToastProvider, AuthProvider, NotificationProvider â€” Correcto.
- **Routing:** React Router v7 com nested routes â€” Moderno e funcional.
- **Estado:** Maioritariamente useState/useEffect locais. Sem Redux/Zustand â€” AceitÃ¡vel para o tamanho actual.

---

*RelatÃ³rio gerado automaticamente por auditoria Claude Code em 2026-02-14.*
